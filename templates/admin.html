<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Administraci√≥n - AirPets Stay</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-light-main: #f8f4f9;
            --bg-light-secondary: #ffffff;
            --text-dark: #292935;
            --text-muted: #6c757d;
            --accent-color: #c90a66;
            --border-color: #ddd;
        }
        body {
            background-color: var(--bg-light-main);
            color: var(--text-dark);
            font-family: 'Quicksand', sans-serif;
        }
        .table {
            --bs-table-bg: var(--bg-light-secondary);
            --bs-table-color: var(--text-dark);
            --bs-table-border-color: var(--border-color);
            --bs-table-hover-bg: #f0eaf1;
        }
        .nav-tabs .nav-link { color: var(--text-muted); border-color: transparent; }
        .nav-tabs .nav-link.active {
            color: var(--accent-color);
            background-color: var(--bg-light-secondary);
            border-color: var(--border-color) var(--border-color) var(--bg-light-secondary);
            font-weight: 700;
        }
        .modal-content { background-color: var(--bg-light-secondary); border-color: var(--border-color); }
        .modal-header, .modal-footer { border-color: var(--border-color); }
        .form-control, .form-select {
            background-color: #f0eaf1;
            color: var(--text-dark);
            border-color: var(--border-color);
        }
        .form-control:focus, .form-select:focus {
            color: var(--text-dark);
            border-color: var(--accent-color);
            box-shadow: 0 0 0 0.2rem rgba(201, 10, 102, .25);
        }
        .btn-accent { background-color: var(--accent-color); border-color: var(--accent-color); color: white; }
        .btn-accent:hover { opacity: 0.9; background-color: var(--accent-color); color: white; }
        .cuidador-photo {
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: 50%;
            background-color: #eee;
            border: 2px solid #e6cadf;
        }
        .page-link { color: var(--accent-color); }
        .page-link:hover { color: #a50854; }
        .page-item.active .page-link { background-color: var(--accent-color); border-color: var(--accent-color); }
    </style>
</head>
<body>
<div class="container-fluid my-4">

    {% macro render_pagination(pagination, endpoint='admin_main', page_type='cu') %}
      {% if pagination and pagination.items and pagination.pages > 1 %}
      <nav aria-label="Navegaci√≥n de p√°ginas" class="mt-4">
          <ul class="pagination justify-content-center">
              <li class="page-item {% if not pagination.has_prev %}disabled{% endif %}">
                  <a class="page-link" href="{{ url_for(endpoint, page=page_type ~ '-' ~ pagination.prev_num) }}">&laquo;</a>
              </li>
              {% for page_num in pagination.iter_pages() %}
                  {% if page_num %}
                      <li class="page-item {% if page_num == pagination.page %}active{% endif %}">
                          <a class="page-link" href="{{ url_for(endpoint, page=page_type ~ '-' ~ page_num) }}">{{ page_num }}</a>
                      </li>
                  {% else %}
                      <li class="page-item disabled"><span class="page-link">‚Ä¶</span></li>
                  {% endif %}
              {% endfor %}
              <li class="page-item {% if not pagination.has_next %}disabled{% endif %}">
                  <a class="page-link" href="{{ url_for(endpoint, page=page_type ~ '-' ~ pagination.next_num) }}">&raquo;</a>
              </li>
          </ul>
      </nav>
      {% endif %}
    {% endmacro %}

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="fw-bold">Panel de Administraci√≥n</h1>
        <div>
            <a href="/" class="btn btn-outline-dark"><i class="bi bi-eye-fill me-1"></i> Ver Sitio P√∫blico</a>
            <a href="{{ url_for('logout') }}" class="btn btn-outline-danger"><i class="bi bi-box-arrow-right me-1"></i> Cerrar Sesi√≥n</a>
        </div>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
            <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <ul class="nav nav-tabs mb-4" id="adminTab" role="tablist">
        <li class="nav-item" role="presentation">
            <a class="nav-link {% if type == 'cuidadores' %}active{% endif %}" href="{{ url_for('admin_main', page='cu-1') }}">üêæ Cuidadores</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link {% if type == 'clientes' %}active{% endif %}" href="{{ url_for('admin_main', page='cl-1') }}">üë§ Clientes</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link {% if type == 'rese√±as' %}active{% endif %}" href="{{ url_for('admin_main', page='re-1') }}">‚≠ê Rese√±as</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link {% if type == 'comentarios' %}active{% endif %}" href="{{ url_for('admin_main', page='co-1') }}">üí¨ Comentarios</a>
        </li>
    </ul>

    <div class="tab-content" id="adminTabContent">
        {% if cuidadores and type == 'cuidadores' %}
        <div class="tab-pane fade show active" id="cuidadores-tab-pane" role="tabpanel">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h3>Gesti√≥n de Cuidadores</h3>
                <button class="btn btn-accent" data-bs-toggle="modal" data-bs-target="#cuidadorModal" data-action="add">
                    <i class="bi bi-plus-circle-fill me-1"></i> A√±adir Cuidador
                </button>
            </div>
            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead><tr><th>Foto</th><th>Nombre</th><th>Ubicaci√≥n</th><th>Coords. (Lat, Lng)</th><th class="text-end">Acciones</th></tr></thead>
                    <tbody>
                        {% for cuidador in cuidadores.items %}
                        <tr>
                            <td><img src="{{ cuidador.foto or url_for('static', filename='assets/img/placeholder.jpg') }}" class="cuidador-photo"></td>
                            <td>{{ cuidador.nombre }}</td>
                            <td>{{ cuidador.ubicacion or 'N/A' }}</td>
                            <td>
                                {% if cuidador.lat is not none and cuidador.lng is not none %}
                                    {{ "%.4f"|format(cuidador.lat) }}, {{ "%.4f"|format(cuidador.lng) }}
                                {% else %}
                                    N/A
                                {% endif %}
                            </td>
                            <td class="text-end">
                                <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#cuidadorModal"
                                    data-action="edit" data-id="{{ cuidador.id }}" data-nombre="{{ cuidador.nombre }}"
                                    data-email="{{ cuidador.email }}" data-descripcion="{{ cuidador.descripcion or '' }}"
                                    data-ubicacion="{{ cuidador.ubicacion or '' }}" data-lat="{{ cuidador.lat or '' }}" data-lng="{{ cuidador.lng or '' }}"
                                    data-rating="{{ cuidador.rating or 0 }}"
                                    data-servicios="{{ (cuidador.servicios or '') if cuidador.servicios is not string else cuidador.servicios }}">
                                    <i class="bi bi-pencil-square"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-danger" data-bs-toggle="modal" data-bs-target="#deleteModal"
                                    data-id="{{ cuidador.id }}" data-nombre="{{ cuidador.nombre }}" data-type="cuidador">
                                    <i class="bi bi-trash-fill"></i>
                                </button>
                            </td>
                        </tr>
                        {% else %}
                        <tr><td colspan="5" class="text-center text-muted">No hay cuidadores para mostrar.</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {{ render_pagination(cuidadores, 'admin_main', 'cu') }}
        </div>
        {% endif %}

        {% if clientes and type == 'clientes' %}
        <div class="tab-pane fade show active" id="clientes-tab-pane" role="tabpanel">
             <div class="d-flex justify-content-between align-items-center mb-3">
                <h3>Gesti√≥n de Clientes</h3>
                <button class="btn btn-accent" data-bs-toggle="modal" data-bs-target="#clienteModal" data-action="add">
                    <i class="bi bi-plus-circle-fill me-1"></i> A√±adir Cliente
                </button>
            </div>
            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead><tr><th>ID</th><th>Nombre</th><th>Email</th><th class="text-end">Acciones</th></tr></thead>
                    <tbody>
                        {% for cliente in clientes.items %}
                        <tr>
                            <td>{{ cliente.id }}</td>
                            <td>{{ cliente.nombre }}</td>
                            <td>{{ cliente.email }}</td>
                            <td class="text-end">
                                <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#clienteModal"
                                    data-action="edit" data-id="{{ cliente.id }}" data-nombre="{{ cliente.nombre }}"
                                    data-email="{{ cliente.email }}">
                                    <i class="bi bi-pencil-square"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-danger" data-bs-toggle="modal" data-bs-target="#deleteModal"
                                    data-id="{{ cliente.id }}" data-nombre="{{ cliente.nombre }}" data-type="cliente">
                                    <i class="bi bi-trash-fill"></i>
                                </button>
                            </td>
                        </tr>
                        {% else %}
                        <tr><td colspan="4" class="text-center text-muted">No hay clientes para mostrar.</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
           {{ render_pagination(clientes, 'admin_main', 'cl') }}
        </div>
        {% endif %}
       
        {% if rese√±as and type == 'rese√±as' %}
        <div class="tab-pane fade show active" id="rese√±as-tab-pane" role="tabpanel">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h3>Gesti√≥n de Rese√±as</h3>
                <button class="btn btn-accent" data-bs-toggle="modal" data-bs-target="#rese√±aModal" data-action="add">
                    <i class="bi bi-plus-circle-fill me-1"></i> A√±adir Rese√±a
                </button>
            </div>
            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead><tr><th>ID</th><th>Rese√±a</th><th>Calificaci√≥n</th><th>Cuidador</th><th>Cliente</th><th class="text-end">Acciones</th></tr></thead>
                    <tbody>
                        {% for rese√±a in rese√±as.items %}
                        <tr>
                            <td>{{ rese√±a.id }}</td>
                            <td class="text-truncate" style="max-width: 250px;">{{ rese√±a.texto }}</td>
                            <td class="text-warning">{% for i in range(rese√±a.calificacion) %}<i class="bi bi-star-fill"></i>{% endfor %}</td>
                            <td>{{ rese√±a.cuidador_nombre }}</td>
                            <td>{{ rese√±a.cliente_nombre }}</td>
                            <td class="text-end">
                                <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#rese√±aModal"
                                    data-action="edit" data-id="{{ rese√±a.id }}" data-texto="{{ rese√±a.texto }}"
                                    data-calificacion="{{ rese√±a.calificacion }}" data-cuidador-id="{{ rese√±a.cuidador_id }}"
                                    data-cliente-id="{{ rese√±a.cliente_id }}">
                                    <i class="bi bi-pencil-square"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-danger" data-bs-toggle="modal" data-bs-target="#deleteModal"
                                    data-id="{{ rese√±a.id }}" data-nombre="Rese√±a #{{ rese√±a.id }}" data-type="rese√±a">
                                    <i class="bi bi-trash-fill"></i>
                                </button>
                            </td>
                        </tr>
                        {% else %}
                        <tr><td colspan="6" class="text-center text-muted">No hay rese√±as para mostrar.</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {{ render_pagination(rese√±as, 'admin_main', 're') }}
        </div>
        {% endif %}

        {% if comentarios and type == 'comentarios' %}
        <div class="tab-pane fade show active" id="comentarios-tab-pane" role="tabpanel">
            <h3>Gesti√≥n de Comentarios</h3>
            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nombre</th>
                            <th>Email</th>
                            <th>Asunto</th>
                            <th style="min-width: 300px;">Mensaje</th>
                            <th class="text-end">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for comentario in comentarios.items %}
                        <tr>
                            <td>{{ comentario.id }}</td>
                            <td>{{ comentario.nombre }}</td>
                            <td><a href="mailto:{{ comentario.email }}">{{ comentario.email }}</a></td>
                            <td>{{ comentario.asunto }}</td>
                            <td>{{ comentario.mensaje }}</td>
                            <td class="text-end">
                                <button class="btn btn-sm btn-outline-danger" data-bs-toggle="modal" data-bs-target="#deleteModal"
                                    data-id="{{ comentario.id }}" data-nombre="Comentario #{{ comentario.id }}" data-type="comentario">
                                    <i class="bi bi-trash-fill"></i>
                                </button>
                            </td>
                        </tr>
                        {% else %}
                        <tr><td colspan="6" class="text-center text-muted">No hay comentarios para mostrar.</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {{ render_pagination(comentarios, 'admin_main', 'co') }}
        </div>
        {% endif %}
    </div>
</div>

<div class="modal fade" id="cuidadorModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <form id="cuidadorForm" method="POST" enctype="multipart/form-data">
                <input type="hidden" name="source_page" value="{{ current_page }}">
                <div class="modal-header"><h5 class="modal-title" id="cuidadorModalLabel"></h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                <div class="modal-body">
                    <input type="hidden" name="id" id="cuidador-id">
                    <div class="row">
                        <div class="col-md-6 mb-3"><label for="cuidador-nombre" class="form-label">Nombre</label><input type="text" class="form-control" id="cuidador-nombre" name="nombre" required></div>
                        <div class="col-md-6 mb-3"><label for="cuidador-email" class="form-label">Email</label><input type="email" class="form-control" id="cuidador-email" name="email" required></div>
                    </div>
                    <div class="mb-3"><label for="cuidador-descripcion" class="form-label">Descripci√≥n</label><textarea class="form-control" id="cuidador-descripcion" name="descripcion" rows="3"></textarea></div>
                    <div class="row">
                        <div class="col-md-8 mb-3"><label for="cuidador-ubicacion" class="form-label">Ubicaci√≥n</label><input type="text" class="form-control" id="cuidador-ubicacion" name="ubicacion"></div>
                        <div class="col-md-4 mb-3"><label for="cuidador-rating" class="form-label">Rating</label><input type="number" step="0.1" class="form-control" id="cuidador-rating" name="rating"></div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3"><label for="cuidador-lat" class="form-label">Latitud</label><input type="number" step="any" class="form-control" id="cuidador-lat" name="lat"></div>
                        <div class="col-md-6 mb-3"><label for="cuidador-lng" class="form-label">Longitud</label><input type="number" step="any" class="form-control" id="cuidador-lng" name="lng"></div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Servicios</label>
                        <div>
                            {% for s in ['Alojamiento', 'Paseos', 'Transporte', 'Peluquer√≠a', 'Cuidado Especializado'] %}
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" name="servicios" value="{{ s }}" id="servicio-{{ s|lower }}">
                                <label class="form-check-label" for="servicio-{{ s|lower }}">{{ s }}</label>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="mb-3"><label for="cuidador-foto" class="form-label">Cambiar Foto</label><input class="form-control" type="file" id="cuidador-foto" name="foto" accept="image/*"></div>
                </div>
                <div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button><button type="submit" class="btn btn-accent">Guardar</button></div>
            </form>
        </div>
    </div>
</div>

<div class="modal fade" id="clienteModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="clienteForm" method="POST">
                <input type="hidden" name="source_page" value="{{ current_page }}">
                <div class="modal-header"><h5 class="modal-title" id="clienteModalLabel"></h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                <div class="modal-body">
                    <input type="hidden" name="id" id="cliente-id">
                    <div class="mb-3"><label for="cliente-nombre" class="form-label">Nombre</label><input type="text" class="form-control" id="cliente-nombre" name="nombre" required></div>
                    <div class="mb-3"><label for="cliente-email" class="form-label">Email</label><input type="email" class="form-control" id="cliente-email" name="email" required></div>
                    <div class="mb-3"><label for="cliente-password" class="form-label">Contrase√±a</label><input type="password" class="form-control" id="cliente-password" name="password"><small class="form-text text-muted">Dejar en blanco para no cambiar</small></div>
                </div>
                <div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button><button type="submit" class="btn btn-accent">Guardar</button></div>
            </form>
        </div>
    </div>
</div>

<div class="modal fade" id="rese√±aModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <form id="rese√±aForm" method="POST">
                <input type="hidden" name="source_page" value="{{ current_page }}">
                <div class="modal-header"><h5 class="modal-title" id="rese√±aModalLabel"></h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                <div class="modal-body">
                    <input type="hidden" name="id" id="rese√±a-id">
                    <div class="mb-3">
                        <label for="rese√±a-cuidador" class="form-label">Cuidador</label>
                        <select class="form-select" name="cuidador_id" id="rese√±a-cuidador" required>
                            <option value="">Selecciona un cuidador...</option>
                            {% for cuidador in all_cuidadores %}
                                <option value="{{ cuidador.id }}">{{ cuidador.nombre }}</option>
                            {% endfor %}
                        </select>
                    </div>
                     <div class="mb-3">
                        <label for="rese√±a-cliente" class="form-label">Cliente</label>
                        <select class="form-select" name="cliente_id" id="rese√±a-cliente" required>
                            <option value="">Selecciona un cliente...</option>
                             {% for cliente in all_clientes %}
                                <option value="{{ cliente.id }}">{{ cliente.nombre }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="rese√±a-texto" class="form-label">Texto de la Rese√±a</label>
                        <textarea class="form-control" id="rese√±a-texto" name="texto" rows="4" required></textarea>
                    </div>
                    <div class="mb-3">
                         <label for="rese√±a-calificacion" class="form-label">Calificaci√≥n</label>
                         <select class="form-select" name="calificacion" id="rese√±a-calificacion" required>
                            <option value="1">1 ‚≠ê</option>
                            <option value="2">2 ‚≠ê‚≠ê</option>
                            <option value="3">3 ‚≠ê‚≠ê‚≠ê</option>
                            <option value="4">4 ‚≠ê‚≠ê‚≠ê‚≠ê</option>
                            <option value="5" selected>5 ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
                         </select>
                    </div>
                </div>
                <div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button><button type="submit" class="btn btn-accent">Guardar</button></div>
            </form>
        </div>
    </div>
</div>

<div class="modal fade" id="deleteModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Confirmar Eliminaci√≥n</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body"><p>¬øEst√°s seguro de que quieres eliminar <strong id="delete-item-name"></strong>? Esta acci√≥n no se puede deshacer.</p></div>
      <div class="modal-footer">
        <form id="deleteForm" method="POST">
            <input type="hidden" name="source_page" value="{{ current_page }}">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="submit" class="btn btn-danger">S√≠, eliminar</button>
        </form>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const cuidadorModal = document.getElementById('cuidadorModal');
    if (cuidadorModal) {
        cuidadorModal.addEventListener('show.bs.modal', function (event) {
            const button = event.relatedTarget;
            const action = button.getAttribute('data-action');
            const form = document.getElementById('cuidadorForm');
            const modalTitle = document.getElementById('cuidadorModalLabel');
            
            if (action === 'edit') {
                modalTitle.textContent = '‚úèÔ∏è Editar Cuidador';
                form.action = `/admin/cuidador/edit/${button.getAttribute('data-id')}`;
                form.querySelector('#cuidador-id').value = button.getAttribute('data-id');
                form.querySelector('#cuidador-nombre').value = button.getAttribute('data-nombre');
                form.querySelector('#cuidador-email').value = button.getAttribute('data-email');
                form.querySelector('#cuidador-descripcion').value = button.getAttribute('data-descripcion');
                form.querySelector('#cuidador-ubicacion').value = button.getAttribute('data-ubicacion');
                form.querySelector('#cuidador-lat').value = button.getAttribute('data-lat');
                form.querySelector('#cuidador-lng').value = button.getAttribute('data-lng');
                form.querySelector('#cuidador-rating').value = button.getAttribute('data-rating');
                const servicios = (button.getAttribute('data-servicios') || "").split(',');
                form.querySelectorAll('input[name="servicios"]').forEach(checkbox => checkbox.checked = servicios.includes(checkbox.value));
            } else {
                modalTitle.textContent = '‚ûï A√±adir Nuevo Cuidador';
                form.action = "/admin/cuidador/add";
                form.reset();
            }
        });
    }

    const clienteModal = document.getElementById('clienteModal');
    if (clienteModal) {
        clienteModal.addEventListener('show.bs.modal', function (event) {
            const button = event.relatedTarget;
            const action = button.getAttribute('data-action');
            const form = document.getElementById('clienteForm');
            const modalTitle = document.getElementById('clienteModalLabel');
            if (action === 'edit') {
                modalTitle.textContent = '‚úèÔ∏è Editar Cliente';
                form.action = `/admin/cliente/edit/${button.getAttribute('data-id')}`;
                form.querySelector('#cliente-id').value = button.getAttribute('data-id');
                form.querySelector('#cliente-nombre').value = button.getAttribute('data-nombre');
                form.querySelector('#cliente-email').value = button.getAttribute('data-email');
                form.querySelector('#cliente-password').placeholder = "Dejar en blanco para no cambiar";
                form.querySelector('#cliente-password').required = false;
            } else {
                modalTitle.textContent = '‚ûï A√±adir Nuevo Cliente';
                form.action = "/admin/cliente/add";
                form.reset();
                form.querySelector('#cliente-password').placeholder = "";
                form.querySelector('#cliente-password').required = true;
            }
        });
    }

    const rese√±aModal = document.getElementById('rese√±aModal');
    if(rese√±aModal) {
        rese√±aModal.addEventListener('show.bs.modal', function (event) {
            const button = event.relatedTarget;
            const action = button.getAttribute('data-action');
            const form = document.getElementById('rese√±aForm');
            const modalTitle = document.getElementById('rese√±aModalLabel');
            if (action === 'edit') {
                modalTitle.textContent = '‚úèÔ∏è Editar Rese√±a';
                form.action = `/admin/rese√±a/edit/${button.getAttribute('data-id')}`;
                form.querySelector('#rese√±a-id').value = button.getAttribute('data-id');
                form.querySelector('#rese√±a-texto').value = button.getAttribute('data-texto');
                form.querySelector('#rese√±a-calificacion').value = button.getAttribute('data-calificacion');
                form.querySelector('#rese√±a-cuidador').value = button.getAttribute('data-cuidador-id');
                form.querySelector('#rese√±a-cliente').value = button.getAttribute('data-cliente-id');
            } else {
                modalTitle.textContent = '‚ûï A√±adir Nueva Rese√±a';
                form.action = "/admin/rese√±a/add";
                form.reset();
            }
        });
    }

    const deleteModal = document.getElementById('deleteModal');
    if (deleteModal) {
        deleteModal.addEventListener('show.bs.modal', function(event) {
            const button = event.relatedTarget;
            const form = document.getElementById('deleteForm');
            const itemType = button.getAttribute('data-type');
            const itemId = button.getAttribute('data-id');
            form.action = `/admin/${itemType}/delete/${itemId}`;
            document.getElementById('delete-item-name').textContent = button.getAttribute('data-nombre');
        });
    }
});
</script>
</body>
</html>